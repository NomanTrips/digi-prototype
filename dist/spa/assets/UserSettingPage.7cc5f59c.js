import{_ as q,X as P,r as U,Y as r,aF as B,a5 as s,K as o,a6 as w,a0 as t,$ as e,ad as $,ac as y,aG as z,d as c,a2 as f,a3 as h,ae as b,ab as I,Z as d,aa as S,af as C,a7 as j,a8 as v,a9 as _}from"./index.b632846d.js";import{Q as D}from"./QBanner.3aaaa684.js";import{Q as u,a as Q,C as V}from"./ClosePopup.bacb9807.js";import{d as A,Q as i,b as m,a as g}from"./position-engine.38973f96.js";import{a as k}from"./index.becf6c0c.js";import{e as F,f as N,g as T,h as E,i as H,_ as L,a as O,b as R,c as G,d as K}from"./human_5.a08aa240.js";var M="/assets/penguin.bdb70ba5.png",X="/assets/diaspora.eba1ec88.png",Y="/assets/big_un.b51dbdea.png";const Z=P({name:"UserSettingsPage",data:function(){return{username:null,user_id:null,avatar:"human_1",bot_avatar:"owley",is_updating:!1,err_msg:"",is_failure:!1,is_signed_in:!1,is_loading:!1,stripe_customer_id:null,subscription_status:"",premium_tf:!1,show_ai_avatars:!1,is_stripe_customer:!1}},computed:{account_tier(){var a=this;return a.premium_tf?"Premium":"Free tier"},getBotAvatarPath(){var a=this;return a.is_loading?"/icons/white_square.png":a.bot_avatar==="green_spark"?"/icons/green_spark.png":a.bot_avatar==="penguin"?"/icons/penguin.png":a.bot_avatar==="default"?"/icons/default.png":a.bot_avatar==="diaspora"?"/icons/diaspora.png":a.bot_avatar==="big_un"?"/icons/big_un.png":a.bot_avatar==="mantis"?"/icons/mantis.png":a.bot_avatar==="orphan"?"/icons/orphan.png":"/icons/owley.png"},getHumanAvatarPath(){var a=this;return a.is_loading?"/icons/white_square.png":a.avatar==="human_2"?"/icons/human_2.png":a.avatar==="human_3"?"/icons/human_3.png":a.avatar==="human_4"?"/icons/human_4.png":a.avatar==="human_5"?"/icons/human_5.png":"/icons/human_1.png"}},created:function(){var a=this;localStorage.user_id&&(a.user_id=localStorage.user_id,a.is_signed_in=!0,a.username=localStorage.username),a.get_billing_details(),a.getSettings(),localStorage.premium_tf==="true"&&(a.premium_tf=!0)},watch:{bot_avatar(a,l){var p=this;p.is_loading===!1&&l!=a&&p.updateSettings()}},methods:{get_billing_details:function(){var a=this;k.get(`https://digissist-server.azurewebsites.net/users/${localStorage.user_id}/billing`).then(function(l){console.log(l),a.stripe_customer_id=l.data.stripe_customer_id,a.stripe_customer_id!=null&&(a.is_stripe_customer=!0),a.subscription_status=l.data.subscription_status,a.subscription_status===null&&(a.subscription_status="N/A")}).catch(function(l){console.log(l),a.is_failure=!0,a.err_msg=l}).then(function(){})},manage_billing:function(){var a=this;k.post("https://digissist-server.azurewebsites.net/stripe/customer_portal",{customer_id:a.stripe_customer_id}).then(function(l){console.log(l),window.location.href=l.data.url}).catch(function(l){console.log(l),a.is_failure=!0,a.err_msg=l}).then(function(){})},set_avatar:function(a){console.log(a);var l=this;l.avatar=a,l.show_avatars=!1,l.updateSettings()},updateSettings:function(){var a=this;a.is_failure=!1,a.is_updating=!0;const l={"Content-Type":"application/json",Authorization:"Bearer "+localStorage.token};k.post(`https://digissist-server.azurewebsites.net/users/${localStorage.user_id}/settings`,{bot_avatar:a.bot_avatar,avatar:a.avatar},{headers:l}).then(function(p){console.log(p),p.status===200?a.$router.go():(a.is_failure=!0,a.err_msg="Failed to update setting")}).catch(function(p){console.log(p),a.is_failure=!0,a.err_msg=p,p.response.status==403&&(localStorage.removeItem("user_id"),localStorage.removeItem("token"),a.is_signed_in=!1,a.$router.push("/login"))}).then(function(){a.is_updating=!1})},getSettings:function(){var a=this;a.is_loading=!0,a.is_signed_in&&k.get(`https://digissist-server.azurewebsites.net/users/${localStorage.user_id}/settings`,{headers:{Authorization:"Bearer "+localStorage.token}}).then(function(l){a.bot_avatar=l.data.bot_avatar,a.avatar=l.data.avatar}).catch(function(l){console.log(l),l.response.status==403&&(localStorage.removeItem("user_id"),localStorage.removeItem("token"),a.is_signed_in=!1,a.$router.push("/login"))}).then(function(){a.is_loading=!1})}},setup(){return{show_avatars:U(!1)}}}),J={class:"q-pa-md q-gutter-sm"},W={class:"q-pa-md row justify-center"},x={style:{width:"100%","max-width":"500px"}},aa={class:"row justify-center"},ta=["src"],ea=f(" Pick an Avatar "),la={class:"row justify-center text-caption"},sa={class:"row justify-center text-subtitle1 q-mt-md q-mb-xs"},ia=s("b",null,"Account type:",-1),na={class:"row justify-center text-body1 q-ma-md"},oa=s("b",null,"Subscription status:",-1),ua=s("div",{class:"row justify-center text-subtitle1 q-mt-md q-mb-xs"},[s("b",null,"AI avatar:")],-1),ra={class:"row justify-center text-subtitle1 q-mb-xs"},da=["src"],_a=f(" Pick an AI Avatar "),ma={class:"row justify-center q-ma-md"},fa=s("div",{class:"text-h6"},"Pick your avatar:",-1),ga={class:"q-pa-md"},pa=s("img",{src:F},null,-1),va=s("img",{src:N},null,-1),ca=s("img",{src:T},null,-1),ba=s("img",{src:E},null,-1),ha=s("img",{src:H},null,-1),ka=s("div",{class:"text-h6"},"Choose AI skin:",-1),wa=f(" Saving... "),$a=f("default"),Va=s("img",{src:L},null,-1),ya=f("green spark"),Sa=s("img",{src:O},null,-1),Ca=f("penguin"),Qa=s("img",{src:M},null,-1),Aa=f("owley"),qa=s("img",{src:R},null,-1),Pa=f("diaspora"),Ua=s("img",{src:X},null,-1),Ba=f("big 'un"),za=s("i",null,"Premium",-1),Ia=s("img",{src:Y},null,-1),ja=f("mantis"),Da=s("i",null,"Premium",-1),Fa=s("img",{src:G},null,-1),Na=f("orphan"),Ta=s("i",null,"Premium",-1),Ea=s("img",{src:K},null,-1);function Ha(a,l,p,La,Oa,Ra){return r(),B(z,null,[s("div",J,[o(t(D,{"inline-actions":"",rounded:"",class:"bg-orange text-white"},{action:e(()=>[t(c,{flat:"",label:"Dismiss"})]),default:e(()=>[f(" Error: "+h(a.err_msg)+" ",1)]),_:1},512),[[w,a.is_failure]])]),s("div",W,[s("div",x,[t($,{class:"my-card"},{default:e(()=>[t(b,null,{default:e(()=>[s("div",aa,[t(c,{round:"",onClick:l[0]||(l[0]=n=>a.show_avatars=!0)},{default:e(()=>[t(u,{size:"64px"},{default:e(()=>[s("img",{src:a.getHumanAvatarPath},null,8,ta)]),_:1}),t(Q,null,{default:e(()=>[ea]),_:1})]),_:1})]),s("div",la,h(a.username),1),s("div",sa,[ia,s("div",{class:"text-subtitle1",style:I([a.premium_tf===!0?{color:"goldenrod"}:{color:"black"}])}," \xA0 "+h(a.account_tier),5)]),s("div",na,[oa,f(" \xA0"+h(a.subscription_status),1)]),ua,s("div",ra,[t(c,{round:"",onClick:l[1]||(l[1]=n=>a.show_ai_avatars=!0)},{default:e(()=>[t(u,{size:"64px"},{default:e(()=>[s("img",{src:a.getBotAvatarPath},null,8,da)]),_:1}),t(Q,null,{default:e(()=>[_a]),_:1})]),_:1})]),s("div",ma,[o(t(c,{color:"pink",outline:"",label:"Manage Billing",onClick:a.manage_billing,class:"q-mx-xs"},null,8,["onClick"]),[[w,a.is_stripe_customer],[V]])])]),_:1})]),_:1})])]),t(y,{modelValue:a.show_avatars,"onUpdate:modelValue":l[7]||(l[7]=n=>a.show_avatars=n)},{default:e(()=>[t($,{class:"my-card",style:{width:"400px"}},{default:e(()=>[t(b,null,{default:e(()=>[fa]),_:1}),t(b,null,{default:e(()=>[s("div",ga,[t(A,{bordered:"",separator:""},{default:e(()=>[o((r(),d(m,{clickable:"",onClick:l[2]||(l[2]=n=>a.set_avatar("human_1"))},{default:e(()=>[t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[pa]),_:1})]),_:1})]),_:1})),[[_]]),o((r(),d(m,{clickable:"",onClick:l[3]||(l[3]=n=>a.set_avatar("human_2"))},{default:e(()=>[t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[va]),_:1})]),_:1})]),_:1})),[[_]]),o((r(),d(m,{clickable:"",onClick:l[4]||(l[4]=n=>a.set_avatar("human_3"))},{default:e(()=>[t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[ca]),_:1})]),_:1})]),_:1})),[[_]]),o((r(),d(m,{clickable:"",onClick:l[5]||(l[5]=n=>a.set_avatar("human_4"))},{default:e(()=>[t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[ba]),_:1})]),_:1})]),_:1})),[[_]]),o((r(),d(m,{clickable:"",onClick:l[6]||(l[6]=n=>a.set_avatar("human_5"))},{default:e(()=>[t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[ha]),_:1})]),_:1})]),_:1})),[[_]])]),_:1})])]),_:1}),t(S),t(C,{align:"right"},{default:e(()=>[o(t(c,{outline:"",color:"pink",label:"Okay"},null,512),[[V]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(y,{modelValue:a.show_ai_avatars,"onUpdate:modelValue":l[16]||(l[16]=n=>a.show_ai_avatars=n)},{default:e(()=>[t($,{class:"my-card",style:{width:"400px"}},{default:e(()=>[t(b,null,{default:e(()=>[ka]),_:1}),t(b,null,{default:e(()=>[s("div",null,[o(s("div",null,[wa,t(j,{color:"pink",size:"2em"})],512),[[w,a.is_updating]]),t(A,null,{default:e(()=>[o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[8]||(l[8]=n=>a.bot_avatar=n),val:"default",color:"pink"},null,8,["modelValue"])]),_:1}),t(i,null,{default:e(()=>[t(g,null,{default:e(()=>[$a]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[Va]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]]),o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[9]||(l[9]=n=>a.bot_avatar=n),val:"green_spark",color:"pink"},null,8,["modelValue"])]),_:1}),t(i,null,{default:e(()=>[t(g,null,{default:e(()=>[ya]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[Sa]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]]),o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[10]||(l[10]=n=>a.bot_avatar=n),val:"penguin",color:"pink"},null,8,["modelValue"])]),_:1}),t(i,null,{default:e(()=>[t(g,null,{default:e(()=>[Ca]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[Qa]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]]),o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[11]||(l[11]=n=>a.bot_avatar=n),val:"owley",color:"pink"},null,8,["modelValue"])]),_:1}),t(i,null,{default:e(()=>[t(g,null,{default:e(()=>[Aa]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[qa]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]]),o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[12]||(l[12]=n=>a.bot_avatar=n),val:"diaspora",color:"pink"},null,8,["modelValue"])]),_:1}),t(i,null,{default:e(()=>[t(g,null,{default:e(()=>[Pa]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[Ua]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]]),o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[13]||(l[13]=n=>a.bot_avatar=n),val:"big_un",color:"amber",disable:!a.premium_tf},null,8,["modelValue","disable"])]),_:1}),t(i,{style:{color:"goldenrod"}},{default:e(()=>[t(g,null,{default:e(()=>[Ba]),_:1}),t(g,{caption:""},{default:e(()=>[za]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[Ia]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]]),o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[14]||(l[14]=n=>a.bot_avatar=n),val:"mantis",color:"amber",disable:!a.premium_tf},null,8,["modelValue","disable"])]),_:1}),t(i,{style:{color:"goldenrod"}},{default:e(()=>[t(g,null,{default:e(()=>[ja]),_:1}),t(g,{caption:""},{default:e(()=>[Da]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[Fa]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]]),o((r(),d(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(i,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":l[15]||(l[15]=n=>a.bot_avatar=n),val:"orphan",color:"amber",disable:!a.premium_tf},null,8,["modelValue","disable"])]),_:1}),t(i,{style:{color:"goldenrod"}},{default:e(()=>[t(g,null,{default:e(()=>[Na]),_:1}),t(g,{caption:""},{default:e(()=>[Ta]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(u,null,{default:e(()=>[Ea]),_:1})]),_:1})]),_:1},8,["disable"])),[[_]])]),_:1})])]),_:1}),t(S),t(C,{align:"right"},{default:e(()=>[o(t(c,{outline:"",color:"pink",label:"Okay"},null,512),[[V]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Ja=q(Z,[["render",Ha]]);export{Ja as default};
