import{_ as q,X as B,r as P,Y as r,aF as z,a5 as l,K as o,a6 as w,a0 as t,$ as e,ad as $,ac as y,aG as I,d as c,a2 as g,a3 as b,ae as p,ab as j,Z as _,aa as V,af as C,a7 as U,a8 as v,a9 as f}from"./index.de272bf2.js";import{Q as D}from"./QBanner.cf4d15ee.js";import{Q as u,a as Q,C as S}from"./ClosePopup.8ff7dba5.js";import{d as A,Q as n,b as m,a as h}from"./position-engine.aaed76da.js";import{a as k}from"./index.becf6c0c.js";import{e as F,f as N,g as T,h as E,i as H,_ as L,a as O,b as R,c as G,d as K}from"./human_5.b1df2911.js";const M=B({name:"UserSettingsPage",data:function(){return{username:null,user_id:null,avatar:"human_1",bot_avatar:"owley",is_updating:!1,err_msg:"",is_failure:!1,is_signed_in:!1,is_loading:!1,stripe_customer_id:null,subscription_status:"",premium_tf:!1,show_ai_avatars:!1,is_stripe_customer:!1}},computed:{account_tier(){var a=this;return a.premium_tf?"Premium":"Free tier"},getBotAvatarPath(){var a=this;return a.is_loading?"/icons/white_square.png":a.bot_avatar==="green_spark"?"/icons/green_spark.png":a.bot_avatar==="penguin"?"/icons/penguin.png":a.bot_avatar==="default"?"/icons/default.png":a.bot_avatar==="diaspora"?"/icons/diaspora.png":"/icons/owley.png"},getHumanAvatarPath(){var a=this;return a.is_loading?"/icons/white_square.png":a.avatar==="human_2"?"/icons/human_2.png":a.avatar==="human_3"?"/icons/human_3.png":a.avatar==="human_4"?"/icons/human_4.png":a.avatar==="human_5"?"/icons/human_5.png":"/icons/human_1.png"}},created:function(){var a=this;localStorage.user_id&&(a.user_id=localStorage.user_id,a.is_signed_in=!0,a.username=localStorage.username),a.get_billing_details(),a.getSettings(),localStorage.premium_tf==="true"&&(a.premium_tf=!0)},watch:{bot_avatar(a,s){var d=this;d.is_loading===!1&&s!=a&&d.updateSettings()}},methods:{get_billing_details:function(){var a=this;k.get(`https://digissist-server.azurewebsites.net/users/${localStorage.user_id}/billing`).then(function(s){console.log(s),a.stripe_customer_id=s.data.stripe_customer_id,a.stripe_customer_id!=null&&(a.is_stripe_customer=!0),a.subscription_status=s.data.subscription_status,a.subscription_status===null&&(a.subscription_status="N/A")}).catch(function(s){console.log(s),a.is_failure=!0,a.err_msg=s}).then(function(){})},manage_billing:function(){var a=this;k.post("https://digissist-server.azurewebsites.net/stripe/customer_portal",{customer_id:a.stripe_customer_id}).then(function(s){console.log(s),window.location.href=s.data.url}).catch(function(s){console.log(s),a.is_failure=!0,a.err_msg=s}).then(function(){})},set_avatar:function(a){console.log(a);var s=this;s.avatar=a,s.show_avatars=!1,s.updateSettings()},updateSettings:function(){var a=this;a.is_failure=!1,a.is_updating=!0;const s={"Content-Type":"application/json",Authorization:"Bearer "+localStorage.token};k.post(`https://digissist-server.azurewebsites.net/users/${localStorage.user_id}/settings`,{bot_avatar:a.bot_avatar,avatar:a.avatar},{headers:s}).then(function(d){console.log(d),d.status===200?a.$router.go():(a.is_failure=!0,a.err_msg="Failed to update setting")}).catch(function(d){console.log(d),a.is_failure=!0,a.err_msg=d,d.response.status==403&&(localStorage.removeItem("user_id"),localStorage.removeItem("token"),a.is_signed_in=!1,a.$router.push("/login"))}).then(function(){a.is_updating=!1})},getSettings:function(){var a=this;a.is_loading=!0,a.is_signed_in&&k.get(`https://digissist-server.azurewebsites.net/users/${localStorage.user_id}/settings`,{headers:{Authorization:"Bearer "+localStorage.token}}).then(function(s){a.bot_avatar=s.data.bot_avatar,a.avatar=s.data.avatar}).catch(function(s){console.log(s),s.response.status==403&&(localStorage.removeItem("user_id"),localStorage.removeItem("token"),a.is_signed_in=!1,a.$router.push("/login"))}).then(function(){a.is_loading=!1})}},setup(){return{show_avatars:P(!1)}}}),X={class:"q-pa-md q-gutter-sm"},Y={class:"q-pa-md row justify-center"},Z={style:{width:"100%","max-width":"500px"}},J={class:"row justify-center"},W=["src"],x=g(" Pick an Avatar "),aa={class:"row justify-center text-caption"},ta={class:"row justify-center text-subtitle1 q-mt-md q-mb-xs"},ea=l("b",null,"Account type:",-1),sa={class:"row justify-center text-body1 q-ma-md"},la=l("b",null,"Subscription status:",-1),ia=l("div",{class:"row justify-center text-subtitle1 q-mt-md q-mb-xs"},[l("b",null,"AI avatar:")],-1),na={class:"row justify-center text-subtitle1 q-mb-xs"},oa=["src"],ua=g(" Pick an AI Avatar "),ra={class:"row justify-center q-ma-md"},da=l("div",{class:"text-h6"},"Pick your avatar:",-1),_a={class:"q-pa-md"},fa=l("img",{src:F},null,-1),ma=l("img",{src:N},null,-1),ga=l("img",{src:T},null,-1),ca=l("img",{src:E},null,-1),pa=l("img",{src:H},null,-1),va=l("div",{class:"text-h6"},"Choose AI skin:",-1),ha=g(" Saving... "),ba=g("default"),ka=l("img",{src:L},null,-1),wa=g("green spark"),$a=l("img",{src:O},null,-1),Sa=g("penguin"),ya=l("img",{src:R},null,-1),Va=g("owley"),Ca=l("img",{src:G},null,-1),Qa=g("diaspora"),Aa=l("img",{src:K},null,-1);function qa(a,s,d,Ba,Pa,za){return r(),z(I,null,[l("div",X,[o(t(D,{"inline-actions":"",rounded:"",class:"bg-orange text-white"},{action:e(()=>[t(c,{flat:"",label:"Dismiss"})]),default:e(()=>[g(" Error: "+b(a.err_msg)+" ",1)]),_:1},512),[[w,a.is_failure]])]),l("div",Y,[l("div",Z,[t($,{class:"my-card"},{default:e(()=>[t(p,null,{default:e(()=>[l("div",J,[t(c,{round:"",onClick:s[0]||(s[0]=i=>a.show_avatars=!0)},{default:e(()=>[t(u,{size:"64px"},{default:e(()=>[l("img",{src:a.getHumanAvatarPath},null,8,W)]),_:1}),t(Q,null,{default:e(()=>[x]),_:1})]),_:1})]),l("div",aa,b(a.username),1),l("div",ta,[ea,l("div",{class:"text-subtitle1",style:j([a.premium_tf===!0?{color:"goldenrod"}:{color:"black"}])}," \xA0 "+b(a.account_tier),5)]),l("div",sa,[la,g(" \xA0"+b(a.subscription_status),1)]),ia,l("div",na,[t(c,{round:"",onClick:s[1]||(s[1]=i=>a.show_ai_avatars=!0)},{default:e(()=>[t(u,{size:"64px"},{default:e(()=>[l("img",{src:a.getBotAvatarPath},null,8,oa)]),_:1}),t(Q,null,{default:e(()=>[ua]),_:1})]),_:1})]),l("div",ra,[o(t(c,{color:"pink",outline:"",label:"Manage Billing",onClick:a.manage_billing,class:"q-mx-xs"},null,8,["onClick"]),[[w,a.is_stripe_customer],[S]])])]),_:1})]),_:1})])]),t(y,{modelValue:a.show_avatars,"onUpdate:modelValue":s[7]||(s[7]=i=>a.show_avatars=i)},{default:e(()=>[t($,{class:"my-card",style:{width:"400px"}},{default:e(()=>[t(p,null,{default:e(()=>[da]),_:1}),t(p,null,{default:e(()=>[l("div",_a,[t(A,{bordered:"",separator:""},{default:e(()=>[o((r(),_(m,{clickable:"",onClick:s[2]||(s[2]=i=>a.set_avatar("human_1"))},{default:e(()=>[t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[fa]),_:1})]),_:1})]),_:1})),[[f]]),o((r(),_(m,{clickable:"",onClick:s[3]||(s[3]=i=>a.set_avatar("human_2"))},{default:e(()=>[t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[ma]),_:1})]),_:1})]),_:1})),[[f]]),o((r(),_(m,{clickable:"",onClick:s[4]||(s[4]=i=>a.set_avatar("human_3"))},{default:e(()=>[t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[ga]),_:1})]),_:1})]),_:1})),[[f]]),o((r(),_(m,{clickable:"",onClick:s[5]||(s[5]=i=>a.set_avatar("human_4"))},{default:e(()=>[t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[ca]),_:1})]),_:1})]),_:1})),[[f]]),o((r(),_(m,{clickable:"",onClick:s[6]||(s[6]=i=>a.set_avatar("human_5"))},{default:e(()=>[t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[pa]),_:1})]),_:1})]),_:1})),[[f]])]),_:1})])]),_:1}),t(V),t(C,{align:"right"},{default:e(()=>[o(t(c,{outline:"",color:"pink",label:"Okay"},null,512),[[S]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(y,{modelValue:a.show_ai_avatars,"onUpdate:modelValue":s[13]||(s[13]=i=>a.show_ai_avatars=i)},{default:e(()=>[t($,{class:"my-card",style:{width:"400px"}},{default:e(()=>[t(p,null,{default:e(()=>[va]),_:1}),t(p,null,{default:e(()=>[l("div",null,[o(l("div",null,[ha,t(U,{color:"pink",size:"2em"})],512),[[w,a.is_updating]]),t(A,null,{default:e(()=>[o((r(),_(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(n,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":s[8]||(s[8]=i=>a.bot_avatar=i),val:"default",color:"pink"},null,8,["modelValue"])]),_:1}),t(n,null,{default:e(()=>[t(h,null,{default:e(()=>[ba]),_:1})]),_:1}),t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[ka]),_:1})]),_:1})]),_:1},8,["disable"])),[[f]]),o((r(),_(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(n,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":s[9]||(s[9]=i=>a.bot_avatar=i),val:"green_spark",color:"pink"},null,8,["modelValue"])]),_:1}),t(n,null,{default:e(()=>[t(h,null,{default:e(()=>[wa]),_:1})]),_:1}),t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[$a]),_:1})]),_:1})]),_:1},8,["disable"])),[[f]]),o((r(),_(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(n,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":s[10]||(s[10]=i=>a.bot_avatar=i),val:"penguin",color:"pink"},null,8,["modelValue"])]),_:1}),t(n,null,{default:e(()=>[t(h,null,{default:e(()=>[Sa]),_:1})]),_:1}),t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[ya]),_:1})]),_:1})]),_:1},8,["disable"])),[[f]]),o((r(),_(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(n,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":s[11]||(s[11]=i=>a.bot_avatar=i),val:"owley",color:"pink"},null,8,["modelValue"])]),_:1}),t(n,null,{default:e(()=>[t(h,null,{default:e(()=>[Va]),_:1})]),_:1}),t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[Ca]),_:1})]),_:1})]),_:1},8,["disable"])),[[f]]),o((r(),_(m,{disable:a.is_updating,tag:"label"},{default:e(()=>[t(n,{avatar:""},{default:e(()=>[t(v,{modelValue:a.bot_avatar,"onUpdate:modelValue":s[12]||(s[12]=i=>a.bot_avatar=i),val:"diaspora",color:"pink"},null,8,["modelValue"])]),_:1}),t(n,null,{default:e(()=>[t(h,null,{default:e(()=>[Qa]),_:1})]),_:1}),t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[Aa]),_:1})]),_:1})]),_:1},8,["disable"])),[[f]])]),_:1})])]),_:1}),t(V),t(C,{align:"right"},{default:e(()=>[o(t(c,{outline:"",color:"pink",label:"Okay"},null,512),[[S]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Ta=q(M,[["render",qa]]);export{Ta as default};
